// Generated by CoffeeScript 1.6.3
/* (c) 2013 Maxim Litvinov*/(function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},t=["img/art-красивые-картинки-fantasy-море-947687.jpeg","img/art-красивые-картинки-usavich-милиция-681232.jpeg","img/art-красивые-картинки-черно-белое-бант-690725.jpeg","img/fantasy-art-красивые-картинки-русалки-801550.jpeg"],n=0;$(function(){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E=document.getElementById("canvas"),S=E.getContext("2d"),x=s=i=m=l=y=u=b=w=a=f=p=d=null,T=function(e){var t,n,r;for(t in e){n=Math.random()*t|0;r=e[t];e[t]=e[n];e[n]=r}return e},N=function(e){return{x:e%x,y:e/x|0}},C=function(e,r){var o;x=e;s=r;i=x*s-1;m=T(function(){var t,n;o=[];for(t=0,n=e*r;0<=n?t<n:t>n;0<=n?t++:t--)o.push(t);return o}.apply(this));l=new Image;l.onload=k;l.src=t[n];return n=(n+1)%t.length},k=function(){var e,t,n,r,o,c,h,v,g;if(l==null||l.width===0)return;S.clearRect(0,0,y,u);e=l.width/l.height;c=u*e;b=(y-c)/2;w=0;a=l.width/x;f=l.height/s;p=c/x;d=u/s;g=[];for(r=h=0,v=m.length;h<v;r=++h){t=m[r];if(t===i)continue;n=N(t);o=N(r);g.push(S.drawImage(l,a*n.x,f*n.y,a,f,b+p*o.x,w+d*o.y,p,d))}return g};window.onresize=v=function(){y=E.width=E.offsetWidth;u=E.height=E.offsetHeight;return k()};v();h=function(){var e,t,n,r;for(t=n=0,r=m.length;n<r;t=++n){e=m[t];if(e!==t)return!1}return!0};c=function(t,n){var r,o;return e.call(function(){var e;r=[];for(e=0;0<=x?e<x:e>x;0<=x?e++:e--)r.push(e);return r}.apply(this),t)>=0&&e.call(function(){var e;o=[];for(e=0;0<=s?e<s:e>s;0<=s?e++:e--)o.push(e);return o}.apply(this),n)>=0&&m[t+n*x]===i};o=function(t,n){var r,i;if(e.call(function(){var e;r=[];for(e=0;0<=x?e<x:e>x;0<=x?e++:e--)r.push(e);return r}.apply(this),t)>=0&&e.call(function(){var e;i=[];for(e=0;0<=s?e<s:e>s;0<=s?e++:e--)i.push(e);return i}.apply(this),n)>=0)return t+n*x};g=function(e,t){var n=m[e];m[e]=m[t];return m[t]=n};E.onclick=r=function(t){var n,r,i,u,a,f;if(h()){C(x+1,s+1);return}r=$(E).offset();i=Math.floor((t.pageX-r.left-b)/p);u=Math.floor((t.pageY-r.top-w)/d);if(e.call(function(){var e;a=[];for(e=0;0<=x?e<x:e>x;0<=x?e++:e--)a.push(e);return a}.apply(this),i)>=0&&e.call(function(){var e;f=[];for(e=0;0<=s?e<s:e>s;0<=s?e++:e--)f.push(e);return f}.apply(this),u)>=0){n=i+u*x;console.log(i,u,n,c(i,u));c(i-1,u)?g(n,o(i-1,u)):c(i+1,u)?g(n,o(i+1,u)):c(i,u-1)?g(n,o(i,u-1)):c(i,u+1)&&g(n,o(i,u+1));return k()}};return C(3,3)})}).call(this);